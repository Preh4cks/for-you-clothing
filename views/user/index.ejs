<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="stylesheets/index.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <title>Foryou Clothing | Aparel Just For You</title>
    <style>
        /* Product List Section */
        #products_list {
          margin: 40px auto;
          max-width: 1280px;
          padding: 0 20px; 
        }
          #products_list > h4 {
            text-align: center;
            margin-bottom: 20px;
          }
          .product_container {
            display: flex;
            flex-wrap: wrap;
          }
          .product_container .item {
            width: 20%;
            text-align: center;
            margin-bottom: 40px;
            position: relative;
          }
            .product_container .item > .img_container {
              width: 100%;
              margin-bottom: 20px;
              padding: 0px 10px;
              max-height: 300px;
              min-height: 300px;
            }
              .product_container .item > .img_container > img {
                width: 100%;
                height: 100%;
                max-height: 300px;
                min-height: 300px;
                object-fit: cover;
                margin: auto;
                margin-bottom: 10px;
                float: right;
              }
              .product_container .item > .img_container > .img2 {
                display: none;
                max-height: 300px;
                min-height: 300px;
                width: 100%;
                height: 100%;
                object-fit: cover;
              }
            .product_container .item > .vendor_name {
              margin-top: 10px;
              display: block;
              font-weight: 600;
            }
            .product_container .item > .product_name {
              display: block;
              height: 40px;
              margin-bottom: 10px;
              padding: 0px 10px;
            }
            .product_container .item > .product_price {
              font-size: 0.8rem;
              margin-bottom: 5px;
              margin-right: 5px;
              font-family: var(--font-arimo);
            }
            .product_container .item > .ratings {
              display: block;
              font-size: 0.8rem;
              font-weight: 600;
              margin-bottom: 5px;
              margin-right: 5px;
              font-family: var(--font-arimo);
            }
            .product_container .item > .product_price.slashed {
              text-decoration: line-through;
              color: var(--color-orange);
            }
            .product_container .item > .sale_tag {
              position: absolute;
              top: 10px;
              right: 0px;
            }
            .product_container .item .jdgm-widget.jdgm-preview-badge.jdgm-preview-badge--with-link.jdgm--done-setup {
              width: auto!important;
              scale: 0.8;
            }
        
        @media (max-width: 768px) {
          .product_container {
            padding: 0px 20px;
          }
          .product_container .item {
            width: 50%;
          }
          .product_container .item > .img_container {
            max-height: initial;
          }
          #products_list { 
            margin: 40px auto;
            padding: 0px;
          }
          #products_list h2 {
            font-size: 1.3rem;
          }
          #products_list p {
            font-size: 0.8rem;
          }
          .product_container .item > .img_container {
              max-height: 250px;
              min-height: 250px;
            }
              .product_container .item > .img_container > img {
                max-height: 250px;
                min-height: 250px;
              }
              .product_container .item > .img_container > .img2 {
                max-height: 250px;
                min-height: 250px;
              }
        }
        
        #user_setting {
          max-width: 1200px;
          margin: 20px auto;
          padding: 0px 20px; 
        }
          #user_setting > h1 {
            font-size: 26px;
            margin-bottom: 10px;
        }


        .banner > img {
          width: 100%;
        }
    </style>        
</head>
<body>
    <nav>
      <div class="container">
          <div class="left">
              <a href="/">
                  <img src="images/foriou logo.png" alt="">
              </a>
          </div>
          <div class="right">
              <a href="/shop">SHOP</a>
              <a href="/cart">CART</a>
            <% if(!user.id) { %>
              <a href="/login">LOGIN</a>
              <a href="/register">REGISTER</a>
            <% } else { %>
              <a href="/account">ACCOUNT</a>
              <a href="/logout">LOGOUT</a>
            <% } %>
          </div>
      </div>
    </nav>
    <div class="banner">
      <img src="images/flash sale banner.png" alt="Flash Sale Banner">
    </div>

    <div id="user_setting">
      <input name="age" type="hidden" value="<%= user.age %>"/>
      <input name="gender" type="hidden" value="<%= user.gender %>"/>
    </div>
    
    <section id="products_list">
      <h4>RECOMMENDED JUST FOR YOU!</h4>
      <div class="product_container"></div>
    </section>

    <script>
        $(document).ready(() => {
          $.get('/products/getSortedProducts', (data) => { 
            console.log(data);     
            let html = '';

            for(let i = 0; i < 5; i++) {
              html += `
                <a href="#" class="item">
                  <div class="img_container">
                    <img src="${ data[i].image_url }" class="img1" loading="eager" width="200" height="267" />
                  </div>
                  <span class="vendor_name">${ data[i].vendor }</span>
                  <span class="product_name">${ data[i].name }</span>
                  
                  ${ (data[i].discounted_price == data[i].unit_price ) ? `<span class="product_price">₱${ data[i].discounted_price }</span>` : `<span class="product_price">₱${ data[i].discounted_price }</span> <span class="product_price slashed">₱${ data[i].unit_price }</span> <span class="sale_tag">SALE</span>` }
                  <span class="ratings">${ ((parseFloat(data[i].rating) / 2) * 10).toFixed(1) } stars</span>
                </a>
              `;
            }
      
            $('.product_container').html(html);
          });
        });
      </script>
</body>
</html>